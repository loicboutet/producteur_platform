<% content_for(:title, "#{@market[:name]} - Silloun") %>

<!-- Breadcrumb -->
<div class="bg-gray-50 py-3">
  <div class="max-w-7xl mx-auto px-4">
    <nav class="text-sm">
      <ol class="flex items-center space-x-2 text-gray-500">
        <li><%= link_to "Accueil", mockups_public_home_index_path, class: "hover:text-silloun-green" %></li>
        <li><span>/</span></li>
        <li><%= link_to "March√©s", mockups_public_markets_path, class: "hover:text-silloun-green" %></li>
        <li><span>/</span></li>
        <li class="text-silloun-green font-medium"><%= @market[:name] %></li>
      </ol>
    </nav>
  </div>
</div>

<!-- Market Header -->
<section class="bg-silloun-green py-10">
  <div class="max-w-7xl mx-auto px-4">
    <div class="grid md:grid-cols-2 gap-8 items-center">
      <!-- Market Info -->
      <div>
        <div class="flex items-center gap-3 mb-4">
          <span class="bg-silloun-yellow text-silloun-green px-3 py-1 rounded-full text-sm font-semibold flex items-center">
            <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path>
            </svg>
            <%= @market[:distance] %> km de vous
          </span>
        </div>
        
        <h1 class="font-piepie text-silloun-yellow text-4xl md:text-5xl mb-2"><%= @market[:name].upcase %></h1>
        <p class="text-white text-lg mb-6"><%= @market[:address] %>, <%= @market[:postal_code] %> <%= @market[:city] %></p>
        
        <!-- Schedule -->
        <div class="bg-white/10 rounded-xl p-6 mb-6">
          <h3 class="text-silloun-yellow font-semibold mb-4 flex items-center">
            <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
            Horaires du march√©
          </h3>
          
          <div class="flex flex-wrap gap-4">
            <% @market[:days].each do |day| %>
              <div class="bg-silloun-yellow text-silloun-green px-4 py-2 rounded-lg">
                <p class="font-bold"><%= day %></p>
                <p class="text-sm"><%= @market[:hours] %></p>
              </div>
            <% end %>
          </div>
        </div>
        
        <!-- Stats -->
        <div class="flex gap-6">
          <div>
            <p class="font-piepie text-silloun-yellow text-3xl"><%= @market[:producers_count] %></p>
            <p class="text-white/60 text-sm">Producteurs pr√©sents</p>
          </div>
          <div>
            <p class="font-piepie text-silloun-yellow text-3xl">50+</p>
            <p class="text-white/60 text-sm">Produits disponibles</p>
          </div>
        </div>
      </div>
      
      <!-- Map -->
      <div class="bg-white rounded-2xl overflow-hidden shadow-lg">
        <div class="h-64 bg-gray-200 flex items-center justify-center relative">
          <!-- Fake map -->
          <div class="absolute inset-0 opacity-20" style="background: linear-gradient(45deg, #ccc 25%, transparent 25%), linear-gradient(-45deg, #ccc 25%, transparent 25%), linear-gradient(45deg, transparent 75%, #ccc 75%), linear-gradient(-45deg, transparent 75%, #ccc 75%); background-size: 20px 20px;"></div>
          
          <!-- Marker -->
          <div class="relative z-10">
            <div class="w-12 h-12 bg-silloun-green rounded-full flex items-center justify-center shadow-lg">
              <svg class="w-6 h-6 text-silloun-yellow" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z" clip-rule="evenodd"></path>
              </svg>
            </div>
            <div class="absolute -bottom-1 left-1/2 transform -translate-x-1/2 w-3 h-3 bg-silloun-green rotate-45"></div>
          </div>
        </div>
        
        <div class="p-4 bg-white">
          <a href="#" class="text-silloun-green font-semibold text-sm flex items-center justify-center hover:text-silloun-green/70 transition">
            <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path>
            </svg>
            Ouvrir dans Google Maps
          </a>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Producers at this Market -->
<section class="py-10 bg-gray-50">
  <div class="max-w-7xl mx-auto px-4">
    <div class="flex items-center justify-between mb-6">
      <h2 class="font-piepie text-silloun-green text-2xl">PRODUCTEURS PR√âSENTS</h2>
      <span class="text-gray-500"><%= @producers.size %> producteurs</span>
    </div>
    
    <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
      <% @producers.each do |producer| %>
        <%= link_to mockups_public_producer_path(producer[:id]), class: "group bg-white rounded-xl shadow-sm hover:shadow-lg transition-all duration-300 overflow-hidden" do %>
          <div class="flex">
            <!-- Producer Photo -->
            <div class="w-1/3 aspect-square bg-gray-200 relative overflow-hidden">
              <%= image_tag producer[:image], 
                  class: "w-full h-full object-cover",
                  alt: producer[:name] %>
            </div>
            
            <!-- Producer Info -->
            <div class="flex-1 p-4">
              <p class="font-marydale text-silloun-yellow text-sm"><%= producer[:specialty] %></p>
              <h3 class="font-semibold text-silloun-green group-hover:text-silloun-green/80 transition">
                <%= producer[:farm_name] %>
              </h3>
              <p class="text-gray-500 text-sm"><%= producer[:name] %></p>
              
              <div class="mt-3 flex items-center justify-between">
                <span class="text-xs text-gray-500">
                  <span class="font-semibold text-silloun-green"><%= producer[:products_count] %></span> produits
                </span>
                <span class="text-silloun-green text-sm font-semibold flex items-center group-hover:translate-x-1 transition-transform">
                  Voir
                  <svg class="w-4 h-4 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                  </svg>
                </span>
              </div>
            </div>
          </div>
        <% end %>
      <% end %>
    </div>
  </div>
</section>

<!-- Products Available at this Market -->
<section class="py-10 bg-white">
  <div class="max-w-7xl mx-auto px-4">
    <div class="flex items-center justify-between mb-6">
      <div>
        <h2 class="font-piepie text-silloun-green text-2xl">PRODUITS DISPONIBLES</h2>
        <p class="text-gray-500 text-sm mt-1">Commandez et r√©cup√©rez au march√©</p>
      </div>
      
      <select class="border rounded-lg px-4 py-2 text-sm focus:ring-silloun-green focus:border-silloun-green">
        <option>Tous les producteurs</option>
        <% @producers.each do |producer| %>
          <option><%= producer[:farm_name] %></option>
        <% end %>
      </select>
    </div>
    
    <!-- Products Grid -->
    <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 md:gap-6">
      <% [
        { id: 1, name: "Tomates Bio", price: 4.50, unit: "kg", producer: "Ferme du Soleil", category: "L√©gumes", available: true },
        { id: 2, name: "Pommes Gala", price: 2.80, unit: "kg", producer: "Les Vergers du Limousin", category: "Fruits", available: true },
        { id: 3, name: "Courgettes", price: 3.20, unit: "kg", producer: "Ferme du Soleil", category: "L√©gumes", available: true },
        { id: 4, name: "Poires Williams", price: 3.50, unit: "kg", producer: "Les Vergers du Limousin", category: "Fruits", available: true },
        { id: 5, name: "Salade", price: 1.50, unit: "pi√®ce", producer: "Ferme du Soleil", category: "L√©gumes", available: true },
        { id: 6, name: "Jus de pomme", price: 5.00, unit: "L", producer: "Les Vergers du Limousin", category: "Boissons", available: true },
        { id: 7, name: "Carottes", price: 2.50, unit: "kg", producer: "Ferme du Soleil", category: "L√©gumes", available: false },
        { id: 8, name: "Cerises", price: 8.00, unit: "kg", producer: "Les Vergers du Limousin", category: "Fruits", available: true }
      ].each do |product| %>
        <%= link_to mockups_public_product_path(product[:id]), class: "group bg-white rounded-xl border border-gray-200 hover:shadow-lg hover:border-silloun-green/30 transition-all duration-300 overflow-hidden" do %>
          <!-- Product Image -->
          <div class="relative aspect-square bg-gray-100">
            <div class="absolute inset-0 flex items-center justify-center">
              <% case product[:category] 
                 when "L√©gumes" %>
                <span class="text-5xl">ü•¨</span>
              <% when "Fruits" %>
                <span class="text-5xl">üçé</span>
              <% when "Boissons" %>
                <span class="text-5xl">üßÉ</span>
              <% else %>
                <span class="text-5xl">üß∫</span>
              <% end %>
            </div>
            
            <% unless product[:available] %>
              <div class="absolute inset-0 bg-black/50 flex items-center justify-center">
                <span class="bg-red-500 text-white px-3 py-1 rounded-full text-sm font-semibold">Rupture</span>
              </div>
            <% end %>
          </div>
          
          <!-- Product Info -->
          <div class="p-3">
            <span class="text-xs text-gray-500"><%= product[:producer] %></span>
            <h3 class="font-semibold text-gray-800 text-sm group-hover:text-silloun-green transition">
              <%= product[:name] %>
            </h3>
            
            <div class="flex items-center justify-between mt-2">
              <p class="font-piepie text-silloun-green text-sm">
                <%= number_to_currency(product[:price], unit: "‚Ç¨", format: "%n %u") %>
                <span class="text-xs font-normal text-gray-500">/ <%= product[:unit] %></span>
              </p>
              
              <% if product[:available] %>
                <span class="w-7 h-7 bg-silloun-yellow rounded-full flex items-center justify-center group-hover:scale-110 transition-transform">
                  <svg class="w-4 h-4 text-silloun-green" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                  </svg>
                </span>
              <% end %>
            </div>
          </div>
        <% end %>
      <% end %>
    </div>
    
    <!-- Load More -->
    <div class="text-center mt-8">
      <button class="bg-silloun-green text-white font-semibold px-6 py-2 rounded-full hover:bg-silloun-green/90 transition text-sm">
        Voir tous les produits
      </button>
    </div>
  </div>
</section>

<!-- How to Order -->
<section class="py-10 bg-silloun-yellow">
  <div class="max-w-7xl mx-auto px-4">
    <div class="text-center mb-8">
      <h2 class="font-piepie text-silloun-green text-2xl">COMMENT COMMANDER ?</h2>
    </div>
    
    <div class="grid md:grid-cols-4 gap-6">
      <div class="text-center">
        <div class="w-12 h-12 bg-silloun-green text-silloun-yellow rounded-full flex items-center justify-center mx-auto mb-3 font-piepie text-xl">1</div>
        <h3 class="font-semibold text-silloun-green mb-1">Choisissez</h3>
        <p class="text-silloun-green/70 text-sm">S√©lectionnez vos produits parmi les producteurs du march√©</p>
      </div>
      
      <div class="text-center">
        <div class="w-12 h-12 bg-silloun-green text-silloun-yellow rounded-full flex items-center justify-center mx-auto mb-3 font-piepie text-xl">2</div>
        <h3 class="font-semibold text-silloun-green mb-1">Payez</h3>
        <p class="text-silloun-green/70 text-sm">R√©glez votre commande en ligne de mani√®re s√©curis√©e</p>
      </div>
      
      <div class="text-center">
        <div class="w-12 h-12 bg-silloun-green text-silloun-yellow rounded-full flex items-center justify-center mx-auto mb-3 font-piepie text-xl">3</div>
        <h3 class="font-semibold text-silloun-green mb-1">Rendez-vous</h3>
        <p class="text-silloun-green/70 text-sm">Allez au march√© aux horaires indiqu√©s</p>
      </div>
      
      <div class="text-center">
        <div class="w-12 h-12 bg-silloun-green text-silloun-yellow rounded-full flex items-center justify-center mx-auto mb-3 font-piepie text-xl">4</div>
        <h3 class="font-semibold text-silloun-green mb-1">R√©cup√©rez</h3>
        <p class="text-silloun-green/70 text-sm">Pr√©sentez votre confirmation au producteur</p>
      </div>
    </div>
  </div>
</section>

<!-- Other Markets -->
<section class="py-10 bg-white">
  <div class="max-w-7xl mx-auto px-4">
    <h2 class="font-piepie text-silloun-green text-2xl mb-6">AUTRES MARCH√âS √Ä PROXIMIT√â</h2>
    
    <div class="grid md:grid-cols-3 gap-4">
      <% [
        { id: 2, name: "March√© de Brive", city: "Brive-la-Gaillarde", days: ["Mardi", "Samedi"], distance: 5.2, producers_count: 12 },
        { id: 3, name: "March√© Bio d'Aurillac", city: "Aurillac", days: ["Mercredi"], distance: 8.7, producers_count: 6 },
        { id: 4, name: "March√© de Tulle", city: "Tulle", days: ["Jeudi"], distance: 10.2, producers_count: 5 }
      ].each do |market| %>
        <%= link_to mockups_public_market_path(market[:id]), class: "group bg-gray-50 rounded-xl p-4 hover:bg-silloun-yellow/10 transition" do %>
          <div class="flex items-center gap-4">
            <div class="w-16 h-16 bg-gray-200 rounded-lg flex items-center justify-center flex-shrink-0">
              <span class="text-2xl">üè™</span>
            </div>
            <div class="flex-1">
              <h3 class="font-semibold text-silloun-green group-hover:text-silloun-green/80"><%= market[:name] %></h3>
              <p class="text-gray-500 text-sm"><%= market[:city] %> ‚Ä¢ <%= market[:distance] %> km</p>
              <div class="flex gap-1 mt-1">
                <% market[:days].each do |day| %>
                  <span class="text-xs bg-silloun-yellow/50 text-silloun-green px-2 py-0.5 rounded"><%= day %></span>
                <% end %>
              </div>
            </div>
            <svg class="w-5 h-5 text-gray-400 group-hover:text-silloun-green transition" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
            </svg>
          </div>
        <% end %>
      <% end %>
    </div>
  </div>
</section>
